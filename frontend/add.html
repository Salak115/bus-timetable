<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>School bus Timetable</title>
    <link rel="stylesheet" href="style.css" />
  </head>

  <body class="add_body">
    <div class="add">
      <h1>Create  Schedule</h1>
      <form id="scheduleForm">
        <!-- Bus Name -->
        <label for="Course">Course:</label>
        <input type="text" id="bus_name" name="bus_name" required />
        <br /><br />

        <label for="Room">Room:</label>
        <input type="text" id="room" name="room" required />
        <br /><br />





        <!-- Day of the Week -->
        <label for="day_of_week">Days:</label>
        <select id="day" name="day" required>
          <option value="Monday">Monday</option>
          <option value="Tuesday">Tuesday</option>
          <option value="Wednesday">Wednesday</option>
          <option value="Thursday">Thursday</option>
          <option value="Friday">Friday</option>
          <option value="Saturday">Saturday</option>
        </select>
        <br /><br />

        <!-- Start Time -->
        <label for="start_time">Start Time:</label>
        <input type="time" id="start_time" name="start_time" required />
        <br /><br />

        <!-- End Time -->
        <label for="end_time">End Time:</label>
        <input type="time" id="end_time" name="end_time" required />
        <br /><br />

        <button type="submit" class="add_btn">Create Schedule</button>
      </form>
    </div>

    <script>
      const form = document.getElementById("scheduleForm");
      form.addEventListener("submit", async (event) => {
        event.preventDefault();

        // Collect form data
        const formData = {
          bus_name: document.getElementById("bus_name").value,
          room: document.getElementById("room").value,
          day: document.getElementById("day").value,
          start_time: document.getElementById("start_time").value,
          end_time: document.getElementById("end_time").value,
        };

        try {
          // Send the data to the backend
          const response = await fetch("http://localhost:3000/add", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(formData),
            credentials: "include", // Include cookies in the request
          });

          if (response.ok) {
            const result = await response.json();
            alert("Schedule created successfully!");
            window.location.href = "/bus-timetable/frontend/index.html";
          } else if (response.status === 403) {
            // Handle authentication error
            alert("You are not authenticated. Please login first.");
            window.location.href =
              "/bus-timetable/frontend/admin_login.html";
          } else {
            const error = await response.text();
            console.log(error)
            alert(`Error: ${error.message}`);
          }
        } catch (err) {
          alert(
            "Failed to send data to the backend. Please check your connection."
          );
          console.error(err);
        }
      });
    </script>
   <style>
    body {
      margin: 0;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
      background-size: 400% 400%;
      animation: gradientBG 15s ease infinite;
      font-family: sans-serif;
    }
  
    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    /* Button hover effect */
button {
  background-color: white;
  color: #7a1fff;
  border: 2px solid #7a1fff;
  padding: 10px 20px;
  border-radius: 8px;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s ease;
}

button:hover {
  background-color: #7a1fff;
  color: white;
  box-shadow: 0 4px 15px rgba(122, 31, 255, 0.4);
  transform: scale(1.05);
}
.wave {
  position: absolute;
  bottom: 0;
  width: 100%;
  height: 150px;
  background: url('wave.svg') no-repeat;
  background-size: cover;
}

  </style>
   